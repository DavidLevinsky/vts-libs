<html>
<head>
<title>Vadstena Map Viewer</title>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
<script type="text/javascript">var f,t={};window.Vadstena=t;t.sa=Array;t.Zc={};t.Zc.create=function(a){var b=new t.sa(2);a&&(b[0]=a[0],b[1]=a[1]);return b};t.Bb={};t.Bb.create=function(a){var b=new t.sa(4);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]);return b};t.Bb.Ib=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};t.J={};t.J.create=function(a){var b=new t.sa(3);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2]);return b};t.J.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b}; t.J.add=function(a,b,c){if(!c||a==c)return a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a;c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];return c};t.J.qd=function(a,b,c){if(!c||a==c)return a[0]-=b[0],a[1]-=b[1],a[2]-=b[2],a;c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];return c};t.J.jd=function(a,b){b||(b=a);b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};t.J.scale=function(a,b,c){if(!c||a==c)return a[0]*=b,a[1]*=b,a[2]*=b,a;c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;return c}; t.J.normalize=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],g=Math.sqrt(c*c+d*d+e*e);if(g){if(1==g)return b[0]=c,b[1]=d,b[2]=e,b}else return b[0]=0,b[1]=0,b[2]=0,b;g=1/g;b[0]=c*g;b[1]=d*g;b[2]=e*g;return b};t.J.cd=function(a,b,c){c||(c=a);var d=a[0],e=a[1];a=a[2];var g=b[0],h=b[1];b=b[2];c[0]=e*b-a*h;c[1]=a*g-d*b;c[2]=d*h-e*g;return c};t.J.length=function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)};t.J.Ib=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}; t.J.direction=function(a,b,c){c||(c=a);var d=a[0]-b[0],e=a[1]-b[1];a=a[2]-b[2];b=Math.sqrt(d*d+e*e+a*a);if(!b)return c[0]=0,c[1]=0,c[2]=0,c;b=1/b;c[0]=d*b;c[1]=e*b;c[2]=a*b;return c};t.J.ed=function(a,b,c,d){d||(d=a);d[0]=a[0]+c*(b[0]-a[0]);d[1]=a[1]+c*(b[1]-a[1]);d[2]=a[2]+c*(b[2]-a[2]);return d};t.J.yb=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+"]"};t.Y={}; t.Y.create=function(a){var b=new t.sa(9);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9]);return b};t.Y.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};t.Y.Tb=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a}; t.Y.wa=function(a,b){if(!b||a==b){var c=a[1],d=a[2],e=a[5];a[1]=a[3];a[2]=a[6];a[3]=c;a[5]=a[7];a[6]=d;a[7]=e;return a}b[0]=a[0];b[1]=a[3];b[2]=a[6];b[3]=a[1];b[4]=a[4];b[5]=a[7];b[6]=a[2];b[7]=a[5];b[8]=a[8];return b};t.Y.Yc=function(a,b){b||(b=t.a.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=0;b[4]=a[3];b[5]=a[4];b[6]=a[5];b[7]=0;b[8]=a[6];b[9]=a[7];b[10]=a[8];b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b}; t.Y.yb=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+"]"};t.a={};t.a.create=function(a){var b=new t.sa(16);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);return b}; t.a.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};t.a.Tb=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}; t.a.wa=function(a,b){if(!b||a==b){var c=a[1],d=a[2],e=a[3],g=a[6],h=a[7],k=a[11];a[1]=a[4];a[2]=a[8];a[3]=a[12];a[4]=c;a[6]=a[9];a[7]=a[13];a[8]=d;a[9]=g;a[11]=a[14];a[12]=e;a[13]=h;a[14]=k;return a}b[0]=a[0];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=a[1];b[5]=a[5];b[6]=a[9];b[7]=a[13];b[8]=a[2];b[9]=a[6];b[10]=a[10];b[11]=a[14];b[12]=a[3];b[13]=a[7];b[14]=a[11];b[15]=a[15];return b}; t.a.dd=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],g=a[4],h=a[5],k=a[6],l=a[7],m=a[8],n=a[9],p=a[10],q=a[11],r=a[12],s=a[13],v=a[14];a=a[15];return r*n*k*e-m*s*k*e-r*h*p*e+g*s*p*e+m*h*v*e-g*n*v*e-r*n*d*l+m*s*d*l+r*c*p*l-b*s*p*l-m*c*v*l+b*n*v*l+r*h*d*q-g*s*d*q-r*c*k*q+b*s*k*q+g*c*v*q-b*h*v*q-m*h*d*a+g*n*d*a+m*c*k*a-b*n*k*a-g*c*p*a+b*h*p*a}; t.a.inverse=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],g=a[3],h=a[4],k=a[5],l=a[6],m=a[7],n=a[8],p=a[9],q=a[10],r=a[11],s=a[12],v=a[13],x=a[14],y=a[15],G=c*k-d*h,H=c*l-e*h,z=c*m-g*h,A=d*l-e*k,B=d*m-g*k,C=e*m-g*l,D=n*v-p*s,E=n*x-q*s,F=n*y-r*s,J=p*x-q*v,K=p*y-r*v,L=q*y-r*x,w=1/(G*L-H*K+z*J+A*F-B*E+C*D);b[0]=(k*L-l*K+m*J)*w;b[1]=(-d*L+e*K-g*J)*w;b[2]=(v*C-x*B+y*A)*w;b[3]=(-p*C+q*B-r*A)*w;b[4]=(-h*L+l*F-m*E)*w;b[5]=(c*L-e*F+g*E)*w;b[6]=(-s*C+x*z-y*H)*w;b[7]=(n*C-q*z+r*H)*w;b[8]=(h*K-k*F+m*D)*w;b[9]= (-c*K+d*F-g*D)*w;b[10]=(s*B-v*z+y*G)*w;b[11]=(-n*B+p*z-r*G)*w;b[12]=(-h*J+k*E-l*D)*w;b[13]=(c*J-d*E+e*D)*w;b[14]=(-s*A+v*H-x*G)*w;b[15]=(n*A-p*H+q*G)*w;return b};t.a.sd=function(a,b){b||(b=t.a.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b}; t.a.Xc=function(a,b){b||(b=t.Y.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[4];b[4]=a[5];b[5]=a[6];b[6]=a[8];b[7]=a[9];b[8]=a[10];return b};t.a.rd=function(a,b){var c=a[0],d=a[1],e=a[2],g=a[4],h=a[5],k=a[6],l=a[8],m=a[9],n=a[10],p=n*h-k*m,q=-n*g+k*l,r=m*g-h*l,s=c*p+d*q+e*r;if(!s)return null;s=1/s;b||(b=t.Y.create());b[0]=p*s;b[1]=(-n*d+e*m)*s;b[2]=(k*d-e*h)*s;b[3]=q*s;b[4]=(n*c-e*l)*s;b[5]=(-k*c+e*g)*s;b[6]=r*s;b[7]=(-m*c+d*l)*s;b[8]=(h*c-d*g)*s;return b}; t.a.multiply=function(a,b,c){c||(c=a);var d=a[0],e=a[1],g=a[2],h=a[3],k=a[4],l=a[5],m=a[6],n=a[7],p=a[8],q=a[9],r=a[10],s=a[11],v=a[12],x=a[13],y=a[14];a=a[15];var G=b[0],H=b[1],z=b[2],A=b[3],B=b[4],C=b[5],D=b[6],E=b[7],F=b[8],J=b[9],K=b[10],L=b[11],w=b[12],aa=b[13],ba=b[14];b=b[15];c[0]=G*d+H*k+z*p+A*v;c[1]=G*e+H*l+z*q+A*x;c[2]=G*g+H*m+z*r+A*y;c[3]=G*h+H*n+z*s+A*a;c[4]=B*d+C*k+D*p+E*v;c[5]=B*e+C*l+D*q+E*x;c[6]=B*g+C*m+D*r+E*y;c[7]=B*h+C*n+D*s+E*a;c[8]=F*d+J*k+K*p+L*v;c[9]=F*e+J*l+K*q+L*x;c[10]=F* g+J*m+K*r+L*y;c[11]=F*h+J*n+K*s+L*a;c[12]=w*d+aa*k+ba*p+b*v;c[13]=w*e+aa*l+ba*q+b*x;c[14]=w*g+aa*m+ba*r+b*y;c[15]=w*h+aa*n+ba*s+b*a;return c};t.a.Ta=function(a,b,c){c||(c=b);var d=b[0],e=b[1];b=b[2];c[0]=a[0]*d+a[4]*e+a[8]*b+a[12];c[1]=a[1]*d+a[5]*e+a[9]*b+a[13];c[2]=a[2]*d+a[6]*e+a[10]*b+a[14];return c}; t.a.Fc=function(a,b){var c;c||(c=b);var d=b[0],e=b[1],g=b[2];b=b[3];c[0]=a[0]*d+a[4]*e+a[8]*g+a[12]*b;c[1]=a[1]*d+a[5]*e+a[9]*g+a[13]*b;c[2]=a[2]*d+a[6]*e+a[10]*g+a[14]*b;c[3]=a[3]*d+a[7]*e+a[11]*g+a[15]*b;return c}; t.a.translate=function(a,b,c){var d=b[0],e=b[1];b=b[2];if(!c||a==c)return a[12]=a[0]*d+a[4]*e+a[8]*b+a[12],a[13]=a[1]*d+a[5]*e+a[9]*b+a[13],a[14]=a[2]*d+a[6]*e+a[10]*b+a[14],a[15]=a[3]*d+a[7]*e+a[11]*b+a[15],a;var g=a[0],h=a[1],k=a[2],l=a[3],m=a[4],n=a[5],p=a[6],q=a[7],r=a[8],s=a[9],v=a[10],x=a[11];c[0]=g;c[1]=h;c[2]=k;c[3]=l;c[4]=m;c[5]=n;c[6]=p;c[7]=q;c[8]=r;c[9]=s;c[10]=v;c[11]=x;c[12]=g*d+m*e+r*b+a[12];c[13]=h*d+n*e+s*b+a[13];c[14]=k*d+p*e+v*b+a[14];c[15]=l*d+q*e+x*b+a[15];return c}; t.a.scale=function(a,b,c){var d=b[0],e=b[1];b=b[2];if(!c||a==c)return a[0]*=d,a[1]*=d,a[2]*=d,a[3]*=d,a[4]*=e,a[5]*=e,a[6]*=e,a[7]*=e,a[8]*=b,a[9]*=b,a[10]*=b,a[11]*=b,a;c[0]=a[0]*d;c[1]=a[1]*d;c[2]=a[2]*d;c[3]=a[3]*d;c[4]=a[4]*e;c[5]=a[5]*e;c[6]=a[6]*e;c[7]=a[7]*e;c[8]=a[8]*b;c[9]=a[9]*b;c[10]=a[10]*b;c[11]=a[11]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c}; t.a.rotate=function(a,b,c,d){var e=c[0],g=c[1];c=c[2];var h=Math.sqrt(e*e+g*g+c*c);if(!h)return null;1!=h&&(h=1/h,e*=h,g*=h,c*=h);var k=Math.sin(b),l=Math.cos(b),m=1-l;b=a[0];var h=a[1],n=a[2],p=a[3],q=a[4],r=a[5],s=a[6],v=a[7],x=a[8],y=a[9],G=a[10],H=a[11],z=e*e*m+l,A=g*e*m+c*k,B=c*e*m-g*k,C=e*g*m-c*k,D=g*g*m+l,E=c*g*m+e*k,F=e*c*m+g*k,e=g*c*m-e*k,g=c*c*m+l;d?a!=d&&(d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15]):d=a;d[0]=b*z+q*A+x*B;d[1]=h*z+r*A+y*B;d[2]=n*z+s*A+G*B;d[3]=p*z+v*A+H*B;d[4]=b*C+q* D+x*E;d[5]=h*C+r*D+y*E;d[6]=n*C+s*D+G*E;d[7]=p*C+v*D+H*E;d[8]=b*F+q*e+x*g;d[9]=h*F+r*e+y*g;d[10]=n*F+s*e+G*g;d[11]=p*F+v*e+H*g;return d};t.a.md=function(a,b,c){var d=Math.sin(b);b=Math.cos(b);var e=a[4],g=a[5],h=a[6],k=a[7],l=a[8],m=a[9],n=a[10],p=a[11];c?a!=c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[4]=e*b+l*d;c[5]=g*b+m*d;c[6]=h*b+n*d;c[7]=k*b+p*d;c[8]=e*-d+l*b;c[9]=g*-d+m*b;c[10]=h*-d+n*b;c[11]=k*-d+p*b;return c}; t.a.nd=function(a,b,c){var d=Math.sin(b);b=Math.cos(b);var e=a[0],g=a[1],h=a[2],k=a[3],l=a[8],m=a[9],n=a[10],p=a[11];c?a!=c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[0]=e*b+l*-d;c[1]=g*b+m*-d;c[2]=h*b+n*-d;c[3]=k*b+p*-d;c[8]=e*d+l*b;c[9]=g*d+m*b;c[10]=h*d+n*b;c[11]=k*d+p*b;return c}; t.a.od=function(a,b,c){var d=Math.sin(b);b=Math.cos(b);var e=a[0],g=a[1],h=a[2],k=a[3],l=a[4],m=a[5],n=a[6],p=a[7];c?a!=c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[0]=e*b+l*d;c[1]=g*b+m*d;c[2]=h*b+n*d;c[3]=k*b+p*d;c[4]=e*-d+l*b;c[5]=g*-d+m*b;c[6]=h*-d+n*b;c[7]=k*-d+p*b;return c}; t.a.xc=function(a,b,c,d,e,g,h){h||(h=t.a.create());var k=b-a,l=d-c,m=g-e;h[0]=2*e/k;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=2*e/l;h[6]=0;h[7]=0;h[8]=(b+a)/k;h[9]=(d+c)/l;h[10]=-(g+e)/m;h[11]=-1;h[12]=0;h[13]=0;h[14]=-(g*e*2)/m;h[15]=0;return h};t.a.perspective=function(a,b,c,d,e){a=c*Math.tan(a*Math.PI/360);b*=a;return t.a.xc(-b,b,-a,a,c,d,e)}; t.a.ld=function(a,b,c,d,e,g,h){h||(h=t.a.create());var k=b-a,l=d-c,m=g-e;h[0]=2/k;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=2/l;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=-2/m;h[11]=0;h[12]=-(a+b)/k;h[13]=-(d+c)/l;h[14]=-(g+e)/m;h[15]=1;return h}; t.a.fd=function(a,b,c,d){d||(d=t.a.create());var e=a[0],g=a[1];a=a[2];var h=c[0],k=c[1],l=c[2];c=b[1];var m=b[2];if(e==b[0]&&g==c&&a==m)return t.a.Tb(d);var n,p,q,r;c=e-b[0];m=g-b[1];b=a-b[2];r=1/Math.sqrt(c*c+m*m+b*b);c*=r;m*=r;b*=r;n=k*b-l*m;l=l*c-h*b;h=h*m-k*c;(r=Math.sqrt(n*n+l*l+h*h))?(r=1/r,n*=r,l*=r,h*=r):h=l=n=0;k=m*h-b*l;p=b*n-c*h;q=c*l-m*n;(r=Math.sqrt(k*k+p*p+q*q))?(r=1/r,k*=r,p*=r,q*=r):q=p=k=0;d[0]=n;d[1]=k;d[2]=c;d[3]=0;d[4]=l;d[5]=p;d[6]=m;d[7]=0;d[8]=h;d[9]=q;d[10]=b;d[11]=0;d[12]= -(n*e+l*g+h*a);d[13]=-(k*e+p*g+q*a);d[14]=-(c*e+m*g+b*a);d[15]=1;return d};t.a.yb=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"]"};t.O={};t.O.create=function(a){var b=new t.sa(4);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]);return b};t.O.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b}; t.O.bd=function(a,b){var c=a[0],d=a[1],e=a[2];if(!b||a==b)return a[3]=-Math.sqrt(Math.abs(1-c*c-d*d-e*e)),a;b[0]=c;b[1]=d;b[2]=e;b[3]=-Math.sqrt(Math.abs(1-c*c-d*d-e*e));return b};t.O.inverse=function(a,b){if(!b||a==b)return a[0]*=1,a[1]*=1,a[2]*=1,a;b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=a[3];return b};t.O.length=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return Math.sqrt(b*b+c*c+d*d+a*a)}; t.O.normalize=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],g=a[3],h=Math.sqrt(c*c+d*d+e*e+g*g);if(0==h)return b[0]=0,b[1]=0,b[2]=0,b[3]=0,b;h=1/h;b[0]=c*h;b[1]=d*h;b[2]=e*h;b[3]=g*h;return b};t.O.multiply=function(a,b,c){c||(c=a);var d=a[0],e=a[1],g=a[2];a=a[3];var h=b[0],k=b[1],l=b[2];b=b[3];c[0]=d*b+a*h+e*l-g*k;c[1]=e*b+a*k+g*h-d*l;c[2]=g*b+a*l+d*k-e*h;c[3]=a*b-d*h-e*k-g*l;return c}; t.O.Ta=function(a,b,c){c||(c=b);var d=b[0],e=b[1],g=b[2];b=a[0];var h=a[1],k=a[2];a=a[3];var l=a*d+h*g-k*e,m=a*e+k*d-b*g,n=a*g+b*e-h*d,d=-b*d-h*e-k*g;c[0]=l*a+d*-b+m*-k-n*-h;c[1]=m*a+d*-h+n*-b-l*-k;c[2]=n*a+d*-k+l*-h-m*-b;return c};t.O.Xc=function(a,b){b||(b=t.Y.create());var c=a[0],d=a[1],e=a[2],g=a[3],h=c+c,k=d+d,l=e+e,m=c*h,n=c*k,c=c*l,p=d*k,d=d*l,e=e*l,h=g*h,k=g*k,g=g*l;b[0]=1-(p+e);b[1]=n-g;b[2]=c+k;b[3]=n+g;b[4]=1-(m+e);b[5]=d-h;b[6]=c-k;b[7]=d+h;b[8]=1-(m+p);return b}; t.O.Yc=function(a,b){b||(b=t.a.create());var c=a[0],d=a[1],e=a[2],g=a[3],h=c+c,k=d+d,l=e+e,m=c*h,n=c*k,c=c*l,p=d*k,d=d*l,e=e*l,h=g*h,k=g*k,g=g*l;b[0]=1-(p+e);b[1]=n-g;b[2]=c+k;b[3]=0;b[4]=n+g;b[5]=1-(m+e);b[6]=d-h;b[7]=0;b[8]=c-k;b[9]=d+h;b[10]=1-(m+p);b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};t.O.pd=function(a,b,c,d){d||(d=a);var e=c;0>a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]&&(e=-1*c);d[0]=1-c*a[0]+e*b[0];d[1]=1-c*a[1]+e*b[1];d[2]=1-c*a[2]+e*b[2];d[3]=1-c*a[3]+e*b[3];return d}; t.O.yb=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"};t.yc=function(a,b,c,d,e,g){var h=b-a,k=d-c,l=g-e;a=t.a.create([2*e/h,0,(b+a)/h,0,0,2*e/k,(d+c)/k,0,0,0,-(g+e)/l,-2*g*e/l,0,0,-1,0]);t.a.wa(a);return a};t.Lc=function(a,b,c,d){a=c*Math.tan(a*Math.PI/360);b*=a;return t.yc(-b,b,-a,a,c,d)}; t.Fa=function(a,b){var c=Math.cos(b),d=Math.sin(b);switch(a){case 0:c=t.a.create([1,0,0,0,0,c,-d,0,0,d,c,0,0,0,0,1]);break;case 1:c=t.a.create([c,0,-d,0,0,1,0,0,d,0,c,0,0,0,0,1]);break;default:c=t.a.create([c,-d,0,0,d,c,0,0,0,0,1,0,0,0,0,1])}t.a.wa(c);return c};t.$a=function(a,b,c){a=t.a.create([a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1]);t.a.wa(a);return a};t.Qc=function(a){return t.$a(a,a,a)};t.pa=function(a,b,c){a=t.a.create([1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1]);t.a.wa(a);return a}; t.td=function(a){return t.pa(a[0],a[1],0)};t.ud=function(a){return t.pa(a[0],a[1],a[2])};t.ia=function(a,b,c){a<b?a=b:a>c&&(a=c);return a};t.ea=function(a){return a*Math.PI/180};t.fc=function(a){var b=7;if(0>a)return a=-a+"",b--,a.length>=b?"-"+a:"-"+(Array(b-a.length+1).join("0")+a);a+="";return a.length>=b?a:Array(b-a.length+1).join("0")+a};t.Sc=function(a,b){return a.replace(/\{([_$a-zA-Z0-9][_$a-zA-Z0-9]*)\}/g,function(a,d){return d in b?b[d]:a})}; t.Wb=function(a,b,c){var d=new XMLHttpRequest;d.onload=function(){var a=d.response;try{var g=eval("("+a+")")}catch(h){null!=c&&c();return}null!=b&&b(g)}.bind(this);d.onerror=function(){null!=c&&c()}.bind(this);d.open("GET",a,!0);d.send("")}; t.Vb=function(a,b,c){var d=new XMLHttpRequest;d.onreadystatechange=function(){switch(d.readyState){case 0:case 1:case 2:case 3:break;case 4:if(404==d.status){null!=c&&c();break}var a=new DataView(d.response);null!=b&&b(a);break;default:null!=c&&c()}}.bind(this);d.onerror=function(){null!=c&&c()}.bind(this);d.open("GET",a,!0);d.responseType="arraybuffer";d.send("")};window.performance=window.performance||{}; performance.now=performance.now||performance.gd||performance.hd||performance.kd||performance.webkitNow||function(){return(new Date).getTime()};window.ic=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)}; function ca(a,b,c){this.D=new u(a);this.$b=this.ac=this.Mb=0;this.Pa=[];this.Oa=[0,0,0];this.tc=c;this.mc=this.Zb=this.bc="";null!=b.foat&&(this.D.k=b.foat[0],this.D.p=b.foat[1],this.D.r=b.foat[2],this.Mb=b.foat[3]);null!=b.meta&&(this.ac=b.meta[0],this.$b=b.meta[1]);this.bc=b.metaTemplate;this.Zb=b.meshTemplate;this.mc=b.textureTemplate;if(null!=b.defaultPosition&&null!=b.defaultOrientation)for(a=0;3>a;a++)this.Pa[a]=b.defaultPosition[a],this.Oa[a]=b.defaultOrientation[a]} function I(a,b){return a.Mb>>b-a.D.k}function da(a,b){return ea(a,a.bc,b)}function fa(a,b){return ea(a,a.Zb,b)}function ga(a,b){return ea(a,a.mc,b)}function ea(a,b,c){b=t.Sc(b,{lod:c.k,easting:t.fc(c.p),northing:t.fc(c.r)});return a.tc+b}function ha(a,b,c){var d=I(a,10),e=Math.round((b[0]-a.D.p)/d),g=Math.round((b[1]-a.D.r)/d);return null!=c?(c[0]=a.D.p+e*d,c[1]=a.D.r+g*d,c[2]=b[2],c):[a.D.p+e*d,a.D.r+g*d,b[2]]} function ia(a){this.gb=1073741824;this.Pb=402653184;this.Ba=4;this.Fb=45;this.hb=6E5;this.Qb=8;this.Rb=32;this.oa="./skydome.jpg";this.ja=[0.8,0.8,0.8];this.da="observer";if(null!=a&&(null!=a.cacheSize&&(this.gb=a.cacheSize),null!=a.gpuCacheSize&&(this.Pb=a.gpuCacheSize),null!=a.numThreads&&(this.Ba=a.numThreads),null!=a.cameraFOV&&(this.Fb=a.cameraFOV),null!=a.cameraVisibility&&(this.hb=a.cameraVisibility),null!=a.gridEmbeddingFactor&&(this.Qb=a.gridEmbeddingFactor),null!=a.gridMinTileSize&&(this.Rb= a.gridMinTileSize),null!=a.skydomeTexture&&(this.oa=a.skydomeTexture),null!=a.controlMode&&(this.da=a.controlMode),null!=a.controlInertia))for(var b=0;3>b;b++)this.ja[b]=a.controlInertia[b]} function ja(a,b,c,d,e,g){this.f=[];this.i=[];this.f[0]=null!=a?a:Number.POSITIVE_INFINITY;this.f[1]=null!=b?b:Number.POSITIVE_INFINITY;this.f[2]=null!=c?c:Number.POSITIVE_INFINITY;this.i[0]=null!=d?d:Number.NEGATIVE_INFINITY;this.i[1]=null!=e?e:Number.NEGATIVE_INFINITY;this.i[2]=null!=g?g:Number.NEGATIVE_INFINITY}function M(a,b){return a.i[b]-a.f[b]}function ka(a,b){return new ja(a.f[0]-b[0],a.f[1]-b[1],a.f[2],a.i[0]-b[0],a.i[1]-b[1],a.i[2])} function la(a){this.ma=[];this.Sa=null!=a?a:Number.MAX_VALUE;this.L=this.V=null;this.ga=0}f=la.prototype;f.log=function(){for(var a=0,b=this.L;null!=b.$&&!(b=this.ma[b.$][3],a++,10<a););this.ma.forEach(function(){})};f.find=function(a){a=this.hash(a);a=this.ma[a];if(null!=a){if(this.L!=a){null!=a.aa&&(a.aa.$=a.$);null!=a.$&&(a.$.aa=a.aa);this.V==a&&(this.V=a.aa);var b=this.L;this.L=a;this.L.$=b;this.L.aa=null;b.aa=this.L}return a.Ra}return null};f.contains=function(a){return null!=this.ma[this.hash(a)]}; f.clear=function(){for(var a=this.L;null!=a;)null!=a.Ra&&a.Ra.v(),a=a.$;this.ma=[];this.L=this.V=null;this.ga=0};function ma(a,b,c,d){b=a.hash(b);c={zc:b,Ra:c,uc:d,aa:null,$:a.L};null!=a.L&&(a.L.aa=c);a.L=c;null==a.V&&(a.V=c);a.ma[b]=c;a.ga+=d;na(a)}function na(a){for(;a.ga>a.Sa;){var b=a.V;if(null!=b)a.V=a.V.aa,null!=a.V&&(a.V.$=null),a.ma[b.zc]=null,a.ga-=b.uc,b.Ra.v();else break}}f.hash=function(a){return""+Math.round(a.k)+"."+Math.round(a.p)+"."+Math.round(a.r)}; function oa(a,b,c,d,e){null==d&&(d=1);this.b=a;this.Ba=d;this.eb=0;this.C=new la(b);this.na=[];this.Va=[];this.la=[];this.cc=c;this.Jb=e}f=oa.prototype;f.get=function(a){var b=this.C.find(a);null==b&&this.sb(a);return b};f.contains=function(a){return this.C.contains(a)};f.trim=function(a){var b=this.C.Sa,c=this.C;c.Sa=a;na(c);a=this.C;a.Sa=b;na(a)};f.reset=function(){this.C.clear()};f.size=function(){return this.C.ga}; f.sb=function(a){var b=this.C.hash(a),c=this.la.indexOf(b);-1==c&&(c=this.na.indexOf(b),-1!=c&&(this.na.splice(c,1),this.Va.splice(c,1)),this.na.unshift(b),this.Va.unshift(a),20<this.na.length&&(this.na.pop(),this.Va.pop()))}; f.update=function(){if(0<this.na.length&&this.eb<this.Ba){var a=this.na.shift(),b=this.Va.shift();if(-1==this.la.indexOf(a)){this.la.push(a);this.eb++;var a=function(a,b){this.la.splice(this.la.indexOf(this.C.hash(a)),1);this.eb--;ma(this.C,a,b,b.size());null!=this.cc&&this.cc(a)}.bind(this),c=function(a){this.la.splice(this.la.indexOf(this.C.hash(a)),1);this.eb--}.bind(this);null!=this.Jb&&new this.Jb(this.b,b,a,c)}}}; function pa(a,b,c){this.c=[0,0,0];this.g=[0,0,0];this.Eb=1;this.Nb=a;this.rb=b;this.xa=c;this.Z=t.a.create();this.Wa=t.a.create();this.Ua=t.a.create();this.X=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];this.jc=[0,0,0,0];this.A=!0}f=pa.prototype;f.Ha=function(a){this.c=a;this.A=!0};f.Ga=function(a){this.g=a;this.A=!0};f.ra=function(){return[this.c[0],this.c[1],this.c[2]]};f.kb=function(){return[this.g[0],this.g[1],this.g[2]]};function qa(a){a.A&&a.update();return a.Z} function ra(a){a.A&&a.update();return a.Wa}function sa(a){a.A&&a.update();return a.Ua}function ta(a,b){a.A&&a.update();for(var c=[[b.f[0],b.f[1],b.f[2],1],[b.f[0],b.f[1],b.i[2],1],[b.f[0],b.i[1],b.f[2],1],[b.f[0],b.i[1],b.i[2],1],[b.i[0],b.f[1],b.f[2],1],[b.i[0],b.f[1],b.i[2],1],[b.i[0],b.i[1],b.f[2],1],[b.i[0],b.i[1],b.i[2],1]],d=0;6>d;d++){for(var e=!0,g=0;8>g;g++)if(0<=t.Bb.Ib(a.X[d],c[g])){e=!1;break}if(e)return!1}return!0} f.update=function(){this.Z=t.a.create();t.a.multiply(t.Fa(1,t.ea(-this.g[2])),t.Fa(0,t.ea(-this.g[1]-90)),this.Z);t.a.multiply(this.Z,t.Fa(2,t.ea(-this.g[0])),this.Z);t.a.multiply(this.Z,t.pa(-this.c[0],-this.c[1],-this.c[2]),this.Z);this.Wa=t.Lc(this.Nb,this.Eb,this.rb,this.xa);this.Ua=t.a.create();t.a.multiply(this.Wa,this.Z,this.Ua);this.X[0]=[0,0,1,1];this.X[1]=[0,0,-1,1];this.X[2]=[1,0,0,1];this.X[3]=[-1,0,0,1];this.X[4]=[0,1,0,1];this.X[5]=[0,-1,0,1];var a=t.a.create();t.a.wa(this.Ua,a);for(var b= 0;6>b;b++)this.X[b]=t.a.Fc(a,this.X[b]);this.A=!1};t.lc=function(a,b,c,d,e,g){var h=e.get(c);if(!h)return[d,c.k>=g];var k=I(a.n,c.k);d=(b[0]-c.p)/k;k=(b[1]-c.r)/k;d=t.ia(d,0,0.9999);var k=t.ia(k,0,0.9999),l=t.ha,m=d*(l-1),n=k*(l-1),p=Math.floor(m),q=Math.floor(n),r=h.Q[q*l+p],s=h.Q[(q+1)*l+p],m=m-p,r=r+(h.Q[q*l+p+1]-r)*m,l=r+(s+(h.Q[(q+1)*l+p+1]-s)*m-r)*(n-q),n=0,n=0.5>k?0.5>d?0:1:0.5>d?2:3;return!(h.T&1<<n)||c.k>=g?[l,!0]:t.lc(a,b,N(c,n),l,e)}; t.La=function(a,b,c){var d;null==d&&(d=Number.MAX_VALUE);return t.lc(a,b,a.n.D,0,c,d)};function O(a,b){this.H=a;this.w=null;this.G=b;this.Hb=null} function ua(a){a.w=document.createElement("canvas");if(null!=a.w&&(a.w.width=a.G[0],a.w.height=a.G[1],a.w.style.display="block",null!=a.w.getContext)){try{a.e=a.w.getContext("webgl")||a.w.getContext("experimental-webgl")}catch(b){}a.e&&(a.H.appendChild(a.w),a.e.Db=a.w.width,a.e.Cb=a.w.height,a.e.clearColor(0,0,0,1),a.e.enable(a.e.DEPTH_TEST),a.e.viewport(0,0,a.e.Db,a.e.Cb),a.e.clear(a.e.COLOR_BUFFER_BIT|a.e.DEPTH_BUFFER_BIT))}} O.prototype.resize=function(a){this.G=a;null!=this.w&&(this.w.width=this.G[0],this.w.height=this.G[1]);null!=this.e&&(this.e.Db=this.w.width,this.e.Cb=this.w.height)};O.prototype.clear=function(){this.e.viewport(0,0,this.e.Db,this.e.Cb);this.e.clear(this.e.DEPTH_BUFFER_BIT);this.e.enable(this.e.CULL_FACE)};O.prototype.useProgram=function(a,b,c){this.Hb!=a&&(this.e.useProgram(a.W),this.Hb=a,va(a),b=a.getAttribute(b),a=a.getAttribute(c),this.e.enableVertexAttribArray(b),this.e.enableVertexAttribArray(a))}; O.prototype.bindTexture=function(a){!1!=a.pb&&(this.e.activeTexture(this.e.TEXTURE0),this.e.bindTexture(this.e.TEXTURE_2D,a.S))};t.ad=function(){return!0}; function P(a,b,c){this.h=b.h;this.e=a.e;this.Qa=c;a=this.e;null!=a&&(this.qa=this.ca=null,this.ca=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.ca),a.bufferData(a.ARRAY_BUFFER,new Float32Array(b.o),a.STATIC_DRAW),this.ca.nb=3,this.ca.tb=b.o.length/3,this.qa=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.qa),a.bufferData(a.ARRAY_BUFFER,new Float32Array(b.s),a.STATIC_DRAW),this.qa.nb=2,this.qa.tb=b.s.length/2,this.P=4*(b.o.length+b.s.length)+32,this.ub=this.ca.tb/3)} P.prototype.v=function(){this.e.deleteBuffer(this.ca);this.e.deleteBuffer(this.qa)};function wa(a,b){var c=a.e;if(null!=c){var d=b.getAttribute("aPosition"),e=b.getAttribute("aTexCoord");c.bindBuffer(c.ARRAY_BUFFER,a.ca);c.vertexAttribPointer(d,a.ca.nb,c.FLOAT,!1,0,0);c.bindBuffer(c.ARRAY_BUFFER,a.qa);c.vertexAttribPointer(e,a.qa.nb,c.FLOAT,!1,0,0);c.drawArrays(c.TRIANGLES,0,a.ca.tb)}}P.prototype.size=function(){return this.P}; function Q(a,b,c){this.e=a.e;this.W=null;this.zb=[];this.fb=[];this.createProgram(b,c)}Q.prototype.createShader=function(a,b){if(!a)return null;var c=this.e;if(null!=c){var d;d=!0!=b?c.createShader(c.FRAGMENT_SHADER):c.createShader(c.VERTEX_SHADER);c.shaderSource(d,a);c.compileShader(d);return c.getShaderParameter(d,c.COMPILE_STATUS)?d:(alert("An error occurred compiling the shaders: "+c.getShaderInfoLog(d)),null)}}; Q.prototype.createProgram=function(a,b){var c=this.e;if(null!=c){var d=this.createShader(a,!0),e=this.createShader(b,!1),g=c.createProgram();c.attachShader(g,d);c.attachShader(g,e);c.linkProgram(g);c.getProgramParameter(g,c.LINK_STATUS)||alert("Unable to initialize the shader program.");c.useProgram(g);this.W=g}};function va(a){var b=a.e;null!=b&&null!=a.W&&(a=a.getUniform("uSampler"),null!=a&&b.uniform1i(a,0))} function R(a,b,c){var d=a.e;null!=d&&null!=a.W&&(a=a.getUniform(b),null!=a&&d.uniformMatrix4fv(a,!1,c))}function xa(a,b,c){var d=a.e;null!=d&&null!=a.W&&(a=a.getUniform(b),null!=a&&d.uniform1f(a,c))}Q.prototype.getAttribute=function(a){var b=this.e;if(null!=b&&null!=this.W)return null==this.fb[a]?(b=b.getAttribLocation(this.W,a),this.fb[a]=b):this.fb[a]}; Q.prototype.getUniform=function(a){var b=this.e;if(null!=b&&null!=this.W)return null==this.zb[a]?(b=b.getUniformLocation(this.W,a),this.zb[a]=b):this.zb[a]};t.Uc="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nuniform mat4 uMVP;\nvarying vec2 vTexCoord;\nvoid main(){ \ngl_Position = uMVP * vec4(aPosition, 1.0);\nvTexCoord = aTexCoord;\n}";t.Tc="precision mediump float;\nuniform sampler2D uSampler;\nvarying vec2 vTexCoord;\nconst vec4 gray = vec4(0.125, 0.125, 0.125, 1.0);\nvoid main() {\nfloat fade = smoothstep(0.51, 0.55, vTexCoord.t);\ngl_FragColor = mix(texture2D(uSampler, vTexCoord), gray, fade);\n}"; t.Cc="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nuniform mat4 uMV, uProj;\nuniform float uFogDensity;\nuniform mat4 uGridMat;\nuniform float uGridStep1, uGridStep2;\nconst int HMSize = 5;\nconst float HMSize1 = float(HMSize-1);\nuniform float uHeight[HMSize*HMSize];\nvarying vec2 vTexCoord1;\nvarying vec2 vTexCoord2;\nvarying float vFogFactor;\nfloat round(float x) { return floor(x + 0.5); }\nvoid main() {\nvec3 pos = aPosition;\nfloat z = uHeight[int(round(pos.y*HMSize1)*float(HMSize) + round(pos.x*HMSize1))];\nvec4 camSpacePos = uMV * vec4(pos.xy, z, 1.0);\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvFogFactor = exp(uFogDensity * camDist);\nvec4 gridCoord = uGridMat * vec4(pos, 1.0);\nvTexCoord1 = aTexCoord;\nvTexCoord1 = gridCoord.xy * vec2(uGridStep1);\nvTexCoord2 = gridCoord.xy * vec2(uGridStep2);\n}"; t.Ac="precision mediump float;\nuniform sampler2D uSampler;\nuniform float uGridBlend;\nvarying vec2 vTexCoord1;\nvarying vec2 vTexCoord2;\nvarying float vFogFactor;\nconst vec4 fogColor = vec4(1, 1, 1, 1);\nvoid main() {\nvec4 gridColor = mix(texture2D(uSampler, vTexCoord1), texture2D(uSampler, vTexCoord2), uGridBlend);\ngl_FragColor = mix(fogColor, gridColor, vFogFactor);\n}";t.Wc="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nuniform mat4 uMV, uProj;\nuniform float uFogDensity;\nvarying vec2 vTexCoord;\nvarying float vFogFactor;\nvoid main() {\nvec4 camSpacePos = uMV * vec4(aPosition, 1.0);\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvFogFactor = exp(uFogDensity * camDist);\nvTexCoord = aTexCoord;\n}"; t.Vc="precision mediump float;\nuniform sampler2D uSampler;\nvarying vec2 vTexCoord;\nvarying float vFogFactor;\nconst vec4 fogColor = vec4(1, 1, 1, 1);\nvoid main() {\ngl_FragColor = mix(fogColor, texture2D(uSampler, vTexCoord), vFogFactor);\n}";function S(a,b,c,d){this.e=a.e;this.S=null;this.P=0;this.Qa=d;this.F=null;this.pb=!1;this.b=c;null!=b&&this.load(b)}S.prototype.v=function(){this.e.deleteTexture(this.S)};S.prototype.size=function(){return this.P}; function ya(a,b,c){var d=a.e;a.S=d.createTexture();d.bindTexture(d.TEXTURE_2D,a.S);c=!0==c?d.REPEAT:d.CLAMP_TO_EDGE;d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,c);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,c);c=!1;switch("linear"){case "linear":d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR);break;case "trilinear":d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR_MIPMAP_LINEAR);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER, d.LINEAR);c=!0;break;default:d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.NEAREST),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST)}d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,b);!0==c&&d.generateMipmap(d.TEXTURE_2D);d.bindTexture(d.TEXTURE_2D,null);a.P=b.naturalWidth*b.naturalHeight*4;a.pb=!0} S.prototype.load=function(a,b,c){this.F=new Image;this.F.crossOrigin="anonymous";this.F.onload=function(){if(null==this.b||!0!=this.b.m)ya(this,this.F,!1),this.F=null}.bind(this);this.F.onerror=function(){null!=this.b&&!0==this.b.m||null==c||c()}.bind(this);this.F.src=a};function za(a,b){this.q=a;this.I=new P(a,b.I);this.S=new S(a);ya(this.S,b.F);this.qb=b.qb;this.mb=b.mb}za.prototype.v=function(){this.I.v();this.S.v()};za.prototype.size=function(){return this.I.size()+this.S.size()}; function Aa(a,b){this.q=a;this.C=new la(b)}Aa.prototype.get=function(a,b){var c=this.C.find(a);if(c)return c;c=new za(this.q,b);ma(this.C,a,c,c.size());return c};Aa.prototype.size=function(){return this.C.ga};Aa.prototype.reset=function(){return this.C.clear()};function T(){this.o=[];this.s=[];this.h=new ja;this.Qa=this.P=0}T.prototype.v=function(){this.o=[];this.s=[];this.h=null}; T.prototype.load=function(a,b,c){t.Vb(a,function(a){this.Qa=a.byteLength;for(var c=0,g=1/65535,h="",k=0;8>k;k++)h+=String.fromCharCode(a.getUint8(c,!0)),c+=1;if("BIN.MESH"==h&&(k=a.getUint32(c,!0),c+=4,!(1<k))){for(k=0;3>k;k++)this.h.f[k]=a.getFloat64(c,!0),c+=8;for(k=0;3>k;k++)this.h.i[k]=a.getFloat64(c,!0),c+=8;for(var h=a.getUint16(c,!0),c=c+2,l=Array(3*h),m=0;m<h;m++)k=3*m,l[k]=a.getUint16(c,!0),c+=2,l[k+1]=a.getUint16(c,!0),c+=2,l[k+2]=a.getUint16(c,!0),c+=2;for(var h=a.getUint16(c,!0),c=c+2, n=Array(2*h),m=0;m<h;m++)k=2*m,n[k]=a.getUint16(c,!0),c+=2,n[k+1]=65535-a.getUint16(c,!0),c+=2;h=a.getUint16(c,!0);c+=2;this.o=Array(9*h);this.s=Array(6*h);for(m=0;m<h;m++){for(k=0;3>k;k++){var p=3*a.getUint16(c,!0),c=c+2,q=9*m+3*k;this.o[q]=l[p]*g;this.o[q+1]=l[p+1]*g;this.o[q+2]=l[p+2]*g}for(k=0;3>k;k++)p=2*a.getUint16(c,!0),c+=2,q=6*m+2*k,this.s[q]=n[p]*g,this.s[q+1]=n[p+1]*g}this.P=8*(this.o.length+this.s.length)+56;null!=b&&b()}}.bind(this),function(){null!=c&&c()}.bind(this))}; T.prototype.size=function(){return this.P};T.prototype.fileSize=function(){return this.Qa};t.bb=function(a,b){b*=Math.PI;a=2*a*Math.PI;return[Math.cos(a)*Math.sin(b)*0.5+0.5,Math.sin(a)*Math.sin(b)*0.5+0.5,0.5*Math.cos(b)+0.5]};t.ha=5; function Ba(a,b,c){this.b=a;this.h=new ja;this.ta=[];this.Q=[];this.T=0;this.Ja=[];for(a=0;2>a;a++)this.ta[a]=[];var d=c.ka.getInt16(c.t,!0);c.t+=2;a=c.ka.getInt16(c.t,!0);c.t+=2;this.h.f[0]=b.p;this.h.f[1]=b.r;this.h.f[2]=d;d=I(this.b.n,b.k);this.h.i[0]=b.p+d;this.h.i[1]=b.r+d;this.h.i[2]=a;for(a=0;2>a;a++)for(b=0;2>b;b++)this.ta[a][b]=c.ka.getFloat32(c.t,!0),c.t+=4;a=0;for(b=t.ha*t.ha;a<b;a++)this.Q[a]=c.ka.getInt16(c.t,!0),c.t+=2;for(a=0;4>a;a++)this.Ja[a]=null;this.T=0} Ba.prototype.ya=function(a,b){var c=b;null!=c?(c[0]=M(this.h,0),c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=M(this.h,1),c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=this.h.f[0]-a[0],c[13]=this.h.f[1]-a[1],c[14]=0,c[15]=1):(c=t.a.create(),t.a.multiply(t.pa(this.h.f[0]-a[0],this.h.f[1]-a[1],0),t.$a(M(this.h,0),M(this.h,1),1),c));return c};Ba.prototype.size=function(){for(var a=308,b=0;4>b;b++)null!=this.Ja[b]&&(a+=this.Ja[b].size());return a}; function Ca(a,b,c){this.u=b;this.b=a;a="";for(var d=0;8>d;d++)a+=String.fromCharCode(c.ka.getUint8(c.t,!0)),c.t+=1;"METATILE"==a&&(a=c.ka.getUint32(c.t,!0),c.t+=4,1<a||(this.nc=Da(this,b,c)))}Ca.prototype.v=function(){};function Da(a,b,c){var d=new Ba(a.b,b,c),e=c.ka.getUint8(c.t,!0);c.t+=1;for(var g=0;4>g;g++)e&1<<g+4&&(d.Ja[g]=Da(a,N(b,g),c));d.T=e&15;return d}Ca.prototype.size=function(){return this.nc.size()}; t.qc=function(a,b,c,d){this.b=a;this.u=b;this.Da=c;this.Ca=d;this.Hc=function(b){!0!=this.b.m&&null!=this.Da&&(b=new Ca(a,this.u,{ka:b,t:0}),this.Da(this.u,b))}.bind(this);this.Gc=function(){!0!=this.b.m&&null!=this.Ca&&this.Ca(this.u)}.bind(this);t.Vb(da(this.b.n,this.u),this.Hc,this.Gc)}; function Ea(a,b,c,d,e){this.b=a;this.K=new oa(a,b,c,d,e);this.contains=this.K.contains.bind(this.K);this.trim=this.K.trim.bind(this.K);this.reset=this.K.reset.bind(this.K);this.sb=this.K.sb.bind(this.K);this.update=this.K.update.bind(this.K);this.size=this.K.size.bind(this.K)} Ea.prototype.get=function(a){for(var b=a,c=this.b.n;Math.abs(b.k-c.ac)%c.$b&&b.k>c.D.k;)b=b.parent();if(b=this.K.get(b)){for(var c=new u(b.b,b.u.k,b.u.p,b.u.r),d=b.nc;c.k<a.k;){var e=I(b.b.n,c.k),g=c.p+e/2,e=c.r+e/2,h=0;Math.round(a.p)>=Math.round(g)&&(h|=1,c.p=g);Math.round(a.r)>=Math.round(e)&&(h|=2,c.r=e);c.k++;(d=d.Ja[h])||console.log("Missing tile metadata")}!c.isEqual(a)&&console.log("Metatile inconsistency");a=d}else a=null;return a};t.xb=1.1; function Fa(a,b,c){this.b=a;this.Ea=this.R=this.ua=null;this.H=b;this.ec=c;this.m=!1;this.G=[b.clientWidth,b.clientHeight];this.Ma=!1;this.A=this.Sb=!0;this.Ec=1;this.q=new O(b,this.G);this.j=new pa(this.b.l.Fb,20,this.b.l.hb);this.c=[this.b.n.Pa[0],this.b.n.Pa[1],this.b.n.Pa[2]];this.g=[this.b.n.Oa[0],this.b.n.Oa[1],this.b.n.Oa[2]];this.N=new Ea(this.b,Number.MAX_VALUE,function(){this.A=!0}.bind(this),this.b.l.Ba,t.qc);this.ba=new t.rc(this.b,Number.MAX_VALUE,function(){this.A=!0}.bind(this),this.b.l.Ba, t.sc);this.lb=new Aa(this.q,this.b.l.Pb);this.oa=this.Ia=this.Aa=this.za=null;this.Bc=!1;this.pc=!0;this.kc=document.getElementById("renderStats");this.Za=this.hc=this.fa=this.vb=this.wb=this.cb=this.Ka=0;this.va=[];this.Xa=this.Ya=0;this.ob=null;this.jb=0;this.Xb=!0;this.Lb=t.a.create();this.Kb=t.a.create();this.vc=[0,0,0];this.wc=t.a.create();this.Mc=t.a.create();this.oc=t.a.create();this.Pc=[0,0,0];this.Oc=[[3,1,2,0],[3,2,1,0],[2,3,0,1],[2,0,3,1],[0,2,1,3],[0,1,2,3],[1,0,3,2],[1,3,0,2]];window.addEventListener("resize", this.dc.bind(this));ua(this.q);this.ua=new Q(this.q,t.Wc,t.Vc);this.R=new Q(this.q,t.Cc,t.Ac);this.Ea=new Q(this.q,t.Uc,t.Tc);Ga(this);Ha(this);Ia(this,this.G[0],this.G[1]);window.ic(this.update.bind(this))}Fa.prototype.dc=function(){!0!=this.m&&Ia(this,this.H.clientWidth,this.H.clientHeight)};Fa.prototype.v=function(){!0!=this.m&&(this.m=!0,this.N.reset(),this.ba.reset(),this.lb.reset(),null!=this.za&&this.za.v(),null!=this.Aa&&this.Aa.v(),null!=this.Ia&&this.Ia.v(),null!=this.oa&&this.oa.v(),this.H.removeChild(this.q.w))}; function Ga(a){var b=new T,c=t.ha;c--;for(var d=0;d<c;d++)for(var e=0;e<c;e++){var g=e/c,h=(e+1)/c,k=d/c,l=(d+1)/c;b.o.push(g,k,0);b.o.push(h,k,0);b.o.push(h,l,0);b.s.push(g,k);b.s.push(h,k);b.s.push(h,l);b.o.push(h,l,0);b.o.push(g,l,0);b.o.push(g,k,0);b.s.push(h,l);b.s.push(g,l);b.s.push(g,k)}b.h.f[0]=b.h.f[1]=b.h.f[2]=0;b.h.i[0]=b.h.i[1]=b.h.i[2]=1;b.P=8*(b.o.length+b.s.length)+56;a.za=new P(a.q,b);b=new Uint8Array(16384);for(c=0;64>c;c++)for(d=0;64>d;d++)e=4*(64*c+d),1>c||63<=c||1>d||63<=d?(b[e]= 255,b[e+1]=255,b[e+2]=255):(b[e]=32,b[e+1]=32,b[e+2]=32),b[e+3]=255;a.Aa=new S(a.q);a=a.Aa;d=!0;c=a.e;a.S=c.createTexture();c.bindTexture(c.TEXTURE_2D,a.S);d=!0==d?c.REPEAT:c.CLAMP_TO_EDGE;c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,d);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,d);d=!1;switch("trilinear"){case "linear":c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR);break;case "trilinear":c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER, c.LINEAR_MIPMAP_LINEAR);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR);d=!0;break;default:c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST)}c.pixelStorei(c.UNPACK_ALIGNMENT,1);c.texImage2D(c.TEXTURE_2D,0,c.RGBA,64,64,0,c.RGBA,c.UNSIGNED_BYTE,b);!0==d&&c.generateMipmap(c.TEXTURE_2D);c.bindTexture(c.TEXTURE_2D,null);a.P=16384;a.pb=!0} function Ha(a){for(var b=new T,c=0;32>c;c++)for(var d=0;64>d;d++){var e=b,g=d/64,h=c/32,k=(d+1)/64,l=(c+1)/32,m=t.bb(g,h),n=[g,h],p=t.bb(g,l),g=[g,l],q=t.bb(k,h),h=[k,h],r=t.bb(k,l),k=[k,l];e.o.push(p[0],p[1],p[2]);e.o.push(m[0],m[1],m[2]);e.o.push(q[0],q[1],q[2]);e.s.push(g[0],g[1]);e.s.push(n[0],n[1]);e.s.push(h[0],h[1]);e.o.push(q[0],q[1],q[2]);e.o.push(r[0],r[1],r[2]);e.o.push(p[0],p[1],p[2]);e.s.push(h[0],h[1]);e.s.push(k[0],k[1]);e.s.push(g[0],g[1]);e.P=8*(e.o.length+e.s.length)+56}b.h.f[0]= b.h.f[1]=b.h.f[2]=0;b.h.i[0]=b.h.i[1]=b.h.i[2]=1;a.Ia=new P(a.q,b);a.oa=new S(a.q,a.b.l.oa,a.b)}function Ia(a,b,c){var d=a.j;d.Eb=b/c;d.A=!0;a.G=[b,c];a.q.resize(a.G);Ja(a)}function Ka(a,b){var c=Math.log(0.05)/(10*a.b.l.hb*(Math.max(5,-a.g[1])/90));xa(b,"uFogDensity",c)} function La(a,b,c,d){null==a.va[b.k]?a.va[b.k]=1:a.va[b.k]++;if(c&&!a.Bc)a.Ya+=c.qb,a.Xa+=c.mb,d=a.lb.get(b,c),a.q.useProgram(a.ua,"aPosition","aTexCoord"),b=a.Lb,t.a.multiply(qa(a.j),c.ya(a.c,a.wc),b),c=ra(a.j),R(a.ua,"uMV",b),R(a.ua,"uProj",c),Ka(a,a.ua),a.q.bindTexture(d.S),wa(d.I,a.ua),a.wb++,a.fa+=d.I.ub;else{a.q.useProgram(a.R,"aPosition","aTexCoord");b=a.Lb;t.a.multiply(qa(a.j),d.ya(a.c,a.Kb),b);R(a.R,"uMV",b);R(a.R,"uProj",ra(a.j));c=a.Kb;d.ya(ha(a.b.n,a.c,a.vc),c);R(a.R,"uGridMat",c);Ka(a, a.R);c=a.b.l.Qb;b=a.b.l.Rb;var e=t.ha,e=Math.log(a.j.c[2]-0.25*(d.Q[0]+d.Q[e-1]+d.Q[(e-1)*e]+d.Q[(e-1)*e+e-1])+20)/Math.log(c),g=Math.pow(c,Math.ceil(e)),h=e-Math.floor(e);xa(a.R,"uGridStep1",b/Math.pow(c,Math.floor(e)));xa(a.R,"uGridStep2",b/g);xa(a.R,"uGridBlend",h);c=a.R;d=d.Q;b=c.e;null!=b&&null!=c.W&&(c=c.getUniform("uHeight"),null!=c&&b.uniform1fv(c,d));a.q.bindTexture(a.Aa);wa(a.za,a.R);a.vb++;a.fa+=a.za.ub}} function Ma(a){var b=t.a.create();t.a.multiply(t.$a(2,2,2),t.pa(-0.5,-0.5,-0.5),b);var c=t.a.create();t.a.multiply(t.pa(a.j.ra()[0],a.j.ra()[1],a.j.ra()[2]-400),t.Qc(0.9*a.j.xa),c);var d=t.a.create();t.a.multiply(sa(a.j),c,d);t.a.multiply(d,b,d);a.q.useProgram(a.Ea,"aPosition","aTexCoord");a.q.bindTexture(a.oa);va(a.Ea);R(a.Ea,"uMVP",d);wa(a.Ia,a.Ea);a.fa+=a.Ia.ub} function Na(a,b){for(var c=b.ya(a.c,a.Mc),d=a.G[0]/2,e=0,g=t.ha,h=t.ha-1,k=0;1>=k;k++)for(var l=0;1>=l;l++){var m=[];t.a.Ta(c,[l,k,b.Q[k*h*g+l*h]],m);var n=a.j;n.A&&n.update();t.a.Ta(n.Z,m,n.jc);m=t.J.length(n.jc);n=(m<n.rb?Number.POSITIVE_INFINITY:n.Wa[0]/m)*b.ta[k][l]*d;n>e&&(e=n)}return e} function Oa(a,b){var c=a.N.get(b);if(!c||!ta(a.j,ka(c.h,a.c)))return 0;if(!(1E6>c.ta[0][0]))return Pa(a,b,c);var d=Na(a,c);if(!c.T||d<t.xb*a.Ec){var e=a.ba.get(b),g;if(!(g=e)){a:if(c.T){for(g=0;4>g;g++)if(c.T&1<<g&&!a.ba.contains(N(b,g))){g=!1;break a}g=!0}else g=!1;g=!g}g?La(a,b,e,c):Pa(a,b,c);return d}if(d=2.2>d)a:{if(a.ba.contains(b)&&1E6>c.ta[0][0])for(d=0;4>d;d++)if(c.T&1<<d&&(g=N(b,d),e=a.ba.get(g),g=a.N.get(g),!e||!g)){d=!0;break a}d=!1}return d?(e=a.ba.get(b),La(a,b,e,c),0):Pa(a,b,c)} function Pa(a,b,c){var d=a.Oc,e;e=c.h;var g=a.Pc;null!=g?(g[0]=0.5*(e.f[0]+e.i[0]),g[1]=0.5*(e.f[1]+e.i[1]),e=g):e=[0.5*(e.f[0]+e.i[0]),0.5*(e.f[1]+e.i[1]),0.5*(e.f[2]+e.i[2])];g=a.j.c;e=Math.floor((Math.atan2(a.c[1]+g[1]-e[1],a.c[0]+g[0]-e[0])+Math.PI)/Math.PI*4);e=t.ia(e,0,7);for(var h=g=0;4>h;h++){var k=d[e][h];c.T&1<<k&&(g=Math.max(g,Oa(a,N(b,k))))}return g} function Qa(a,b){var c=a.N.get(b);if(!c||!ta(a.j,ka(c.h,a.c)))return 0;if(1E6>c.ta[0][0]){var d=Na(a,c);if(!c.T||d<t.xb)return d}for(var e=d=0;4>e;e++)c.T&1<<e&&(d=Math.max(d,Qa(a,N(b,e))));return d} function U(a){switch(a.b.l.da){case "observer":a.g[1]=t.ia(a.g[1],-90,10);a.c[2]=t.ia(a.c[2],5,a.j.xa);t.a.multiply(t.Fa(2,t.ea(a.g[0])),t.Fa(0,t.ea(a.g[1])),a.oc);var b=[0,-a.c[2],0];t.a.Ta(a.oc,b);b[2]+=t.La(a.b,a.c,a.N)[0];a.j.Ha(b);a.j.Ga(a.g);break;case "drone":a.g[1]=t.ia(a.g[1],-90,90);a.c[2]=t.ia(a.c[2],5,a.j.xa);b=a.j.c;a.j.Ha([0,0,a.c[2]+t.La(a.b,[a.c[0]+b[0],a.c[1]+b[1]],a.N)[0]]);a.j.Ga(a.g);break;case "manual":a.j.Ha([0,0,a.c[2]]),a.j.Ga(a.g)}a.A=!0} function V(a){var b=a.j.c;return a.j.ra()[2]-t.La(a.b,[a.c[0]+b[0],a.c[1]+b[1]],a.N)[0]} function Ra(a,b){var c=!1;if("manual"==a.b.l.da)return!1;var d=1E3;if(!0==a.Xb){var e=20,e=Math.max(20,0.1*a.c[2]);if(a.Ma||-10<a.g[1]){var g=function(a,b,c){var d=0.5*(a+b);if(20<c)return d;this.g[1]=d;U(this);return V(this)<e?g(a,d,c+1):g(d,b,c+1)}.bind(a);V(a)<e&&(c=!0,a.g[1]=g(-89,Math.min(-1,a.g[1]),0),U(a))}else for(;V(a)<e&&0<d;)c=!0,a.c[2]+=0.01,U(a),d--;return!1}for(;(b>t.xb||0>V(a))&&0<d;){c=!0;if("observer"==a.b.l.da)if(a.Ma||-10<a.g[1])250>a.c[2]?a.c[2]+=0.3:a.g[1]-=0.3;else{var h=t.ea(a.g[0]), k=t.ea(-a.g[1]),l=0.5/Math.sin(k),k=l*Math.cos(k),h=[-Math.sin(h),Math.cos(h),0];a.c[0]+=k*h[0];a.c[1]+=k*h[1];a.c[2]+=l}else a.c[2]+=0.5;U(a);b=Qa(a,a.b.n.D);d--}return c}function Ja(a){if("drone"==a.b.l.da&&!a.Sb){var b=t.La(a.b,a.c,a.N);if(!b[1])return;a.c[2]+=b[0];a.Sb=!0}b=0;if(!0==a.Xb)Ra(a,b),a.q.clear(),U(a),Oa(a,a.b.n.D),Ma(a);else{do a.q.clear(),U(a),b=Oa(a,a.b.n.D),Ma(a);while(Ra(a,b))}a.N.trim(a.b.l.gb/10);a.ba.trim(a.b.l.gb);a.Ma=!1} Fa.prototype.update=function(){if(!0!=this.m){if(null==this.H||"hidden"!=this.H.style.visibility){this.G[0]==this.H.clientWidth&&this.G[1]==this.H.clientHeight||this.dc();null!=this.ec&&this.ec();this.N.update();this.ba.update();if(!0==this.pc&&(this.fa=this.vb=this.wb=0,this.va=[],this.Xa=this.Ya=0,this.Ka++,10<=this.Ka)){var a=Date.now();null!=this.ob&&(this.jb=0.5*(1E3/(a-this.ob)*this.Ka+this.jb));this.ob=a}a=performance.now();!0==this.A&&Ja(this);if(!0==this.pc&&(this.cb++,this.Za+=performance.now()- a,100<=this.cb&&(this.hc=this.Za/this.cb,this.cb=this.Za=0),null!=this.kc&&10<=this.Ka&&(this.Ka=0,!0==this.A))){text_="Redered tiles: "+(this.wb+this.vb)+"<br/>Tile cache: "+Math.round(this.ba.size()/1048576)+"MB<br/>Metatile cache: "+Math.round(this.N.size()/1048576)+"MB<br/>GPU cache: "+Math.round(this.lb.size()/1048576)+"MB<br/>Polygons: "+this.fa+"<br/>Render time: "+Math.round(1E3*this.hc)+"<br/>FPS: "+Math.round(this.jb)+"<br/>Texture files size: "+Math.round(this.Xa/1048576)+"MB<br/>Mesh files size: "+ Math.round(this.Ya/1048576)+"MB<br/>LODs tiles:<br/>";for(var b in this.va)text_+="LOD"+b+": "+this.va[b]+"<br/>";this.kc.innerHTML=text_}this.A=!1}window.ic(this.update.bind(this))}};function Sa(a,b,c,d){this.b=a;this.u=b;this.I=c;this.F=d;this.P=this.I.size()+d.naturalWidth*d.naturalHeight*3;this.qb=c.fileSize();this.mb=d.naturalWidth*d.naturalHeight*3}Sa.prototype.v=function(){null!=this.I&&(this.I.v(),this.I=null);this.F=null}; Sa.prototype.ya=function(a,b){var c=I(this.b.n,this.u.k),d=c/2+this.u.p-a[0],c=c/2+this.u.r-a[1],e=this.I.h,g=b;null!=g?(g[0]=M(e,0),g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=M(e,1),g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=M(e,2),g[11]=0,g[12]=e.f[0]+d,g[13]=e.f[1]+c,g[14]=e.f[2],g[15]=1):(g=t.a.create(),t.a.multiply(t.pa(e.f[0]+d,e.f[1]+c,e.f[2]),t.$a(M(e,0),M(e,1),M(e,2)),g));return g};Sa.prototype.size=function(){return this.P};t.rc=oa; t.sc=function(a,b,c,d){this.b=a;this.u=b;this.Da=c;this.Ca=d;this.ib=this.Ub=this.Yb=!1;this.Na=function(){!0==this.ib?null!=this.Ca&&this.Ca(this.u):!0==this.Yb&&!0==this.Ub&&null!=this.Da&&this.Da(this.u,new Sa(this.b,this.u,this.I,this.F))}.bind(this);this.F=new Image;this.F.onload=function(){!0!=this.b.m&&(this.Ub=!0,this.Na())}.bind(this);this.F.onerror=function(){!0!=this.b.m&&(this.ib=!0,this.Na())}.bind(this);this.F.crossOrigin="anonymous";this.F.src=ga(this.b.n,this.u);this.I=new T;this.Jc= function(){!0!=this.b.m&&(this.Yb=!0,this.Na())}.bind(this);this.Ic=function(){!0!=this.b.m&&(this.ib=!0,this.Na())}.bind(this);this.I.load(fa(this.b.n,this.u),this.Jc,this.Ic)};function u(a,b,c,d){this.b=a;this.k=null!=b?b:0;this.p=null!=c?c:0;this.r=null!=d?d:0}function N(a,b){var c=I(a.b.n,a.k),d=a.p+c/2,c=a.r+c/2;switch(b){case 0:return new u(a.b,a.k+1,a.p,a.r);case 1:return new u(a.b,a.k+1,d,a.r);case 2:return new u(a.b,a.k+1,a.p,c);case 3:return new u(a.b,a.k+1,d,c)}} u.prototype.parent=function(){var a=I(this.b.n,this.k),b=this.b.n.D;return new u(this.b,this.k-1,b.p+((this.p-b.p)/a&-2)*a,b.r+((this.r-b.r)/a&-2)*a)};u.prototype.isEqual=function(a){return this.k==a.k&&this.p==a.p&&this.r==a.r}; function W(a,b,c,d,e){if(null!=b&&""!=b){this.M=[];this.B=[];this.U=[];this.Ab=this.l=this.n=this.d=null;this.m=!1;this.H=null;var g="";"string"===typeof b&&(g=b.split("?")[0].split("/").slice(0,-1).join("/")+"/");"string"===typeof a?this.H=document.getElementById(a):"object"===typeof a&&(this.H=a);if(null==this.H)null!=d&&d(!1,"DOM element does not exist");else{var h=null,k=null,l=function(){null==h||null==k&&null!=c||(this.n=new ca(this,h,g),this.l=new ia(k),this.Ab=e,this.d=new Fa(this,this.H, this.Kc.bind(this)),null!=d&&d(!0))}.bind(this);a=function(a){h=a;l()}.bind(this);var m=function(a){k=a;l()}.bind(this),n=function(a){null!=d&&d(!1,a+" config not found")}.bind(this);null!=c&&"string"===typeof c&&t.Wb(c,m,n.bind(this,"browser"));"string"===typeof b&&t.Wb(b,a,n.bind(this,"map"));"object"===typeof b&&(h=b);"object"===typeof c&&(k=c);null==h&&null==k||l()}}}f=W.prototype;f.v=function(){this.d.v();this.m=!0}; f.ab=function(a){if(!0!=this.m&&null!=this.d&&null!=this.d.j&&this.l.da!=a){if("manual"==a){var b;b=!0!=t.m&&null!=t.d?t.La(t.b,[this.d.c[0],this.d.c[1]],t.d.N):void 0;b[0]>this.d.c[2]&&(this.d.c[2]=b[0]+100)}this.l.da=a;U(this.d);this.M=[];this.U=[];this.B=[]}};f.Ob=function(){return this.l.da};f.Ha=function(a,b,c){!0!=this.m&&null!=this.d&&(this.d.c=[a,b,c],U(this.d))};f.ra=function(){return!0==this.m||null==this.d?[0,0,0]:[this.d.c[0],this.d.c[1],this.d.c[2]]}; f.Ga=function(a,b,c){!0!=this.m&&null!=this.d&&(this.d.g=[a,b,c],U(this.d))};f.kb=function(){return!0==this.m||null==this.d?[0,0,0]:this.d.g};f.Rc=function(a,b){if(null!=this.d&&null!=this.d.j){var c=this.d.j;c.Nb=a;c.rb=20;c.xa=b;c.A=!0;U(this.d)}};f.Dc=function(){return[0,0,0]};f.Nc=function(){return[0,0,0]};f.$c=function(){return[[0,0],[1,0],[0,1]]}; f.gc=function(a,b){if(!0!=this.m&&null!=this.d){var c=V(this.d)/800;a*=c;b*=c;var d=t.ea(this.kb()[0]),c=[-Math.sin(d),Math.cos(d)],d=[Math.cos(d),Math.sin(d)];this.d.c[0]+=c[0]*b-d[0]*a;this.d.c[1]+=c[1]*b-d[1]*a;0<this.l.ja[0]&&this.M.push([c[0]*b-d[0]*a,c[1]*b-d[1]*a]);U(this.d)}};f.rotate=function(a,b,c){!0!=this.m&&null!=this.d&&(null==c&&(c=0),this.d.g[0]+=0.3*-a,this.d.g[1]+=0.3*-b,this.d.g[2]+=0.3*c,0<this.l.ja[1]&&this.B.push([0.3*-a,0.3*-b,0.3*c]),this.d.Ma=!0,U(this.d))}; f.zoom=function(a){!0!=this.m&&null!=this.d&&(a=1+0.001*a,this.d.c[2]*=a,0<this.l.ja[2]&&this.U.push([a]),U(this.d))}; f.Kc=function(){if(!0!=this.m&&null!=this.d){var a=!1,b=this.l.ja[0],c=this.l.ja[1],d=this.l.ja[2];0<this.B.length&&0==this.M.length&&0==this.U.length&&(this.d.Ma=!0);for(var e=0;e<this.M.length;e++)this.M[e][0]*=b,this.M[e][1]*=b,this.d.c[0]+=this.M[e][0],this.d.c[1]+=this.M[e][1],0.01>Math.abs(this.M[e][0])+Math.abs(this.M[e][1])&&(this.M.splice(e,1),e--),a=!0;for(e=0;e<this.U.length;e++)this.U[e][0]+=(1-this.U[e][0])*(1-d),this.d.c[2]*=this.U[e][0],this.d.c[2]=Math.min(this.d.c[2],4E5),0.001>Math.abs(1- this.U[e][0])&&(this.U.splice(e,1),e--),a=!0;for(e=0;e<this.B.length;e++)this.B[e][0]*=c,this.B[e][1]*=c,this.B[e][2]*=c,this.d.g[0]+=this.B[e][0],this.d.g[1]+=this.B[e][1],this.d.g[2]+=this.B[e][2],0.01>Math.abs(this.B[e][0])+Math.abs(this.B[e][1])+Math.abs(this.B[e][2])&&(this.B.splice(e,1),e--),a=!0;!0==a&&U(this.d);null!=this.Ab&&this.Ab()}}; t.Gb=function(){var a=document.createElement("canvas");if(null==a)return!1;a.width=1024;a.height=768;if(null==a.getContext)return!1;var b=null;try{b=a.getContext("webgl")||a.getContext("experimental-webgl")}catch(c){return!1}return b?!0:!1};t.Browser=W;W.prototype.setControlMode=W.prototype.ab;W.prototype.getControlMode=W.prototype.Ob;W.prototype.setPosition=W.prototype.Ha;W.prototype.getPosition=W.prototype.ra;W.prototype.setOrientation=W.prototype.Ga;W.prototype.getOrientation=W.prototype.kb; W.prototype.setCamera=W.prototype.Rc;W.prototype.hitTest=W.prototype.Dc;W.prototype.project=W.prototype.Nc;W.prototype.visibleArea=W.prototype.$c;W.prototype.pan=W.prototype.gc;W.prototype.rotate=W.prototype.rotate;W.prototype.zoom=W.prototype.zoom;W.prototype.kill=W.prototype.v;t.checkSupport=t.Gb;var X=null;function Ta(a,b){!1==a&&alert("Vadstena3D initialization failed. Reason: "+b)}var Y=!1,Z=!1,$=!1,Ua=!1,Va=!1,Wa=0,Xa=0,Ya=0,Za=0; function $a(a){var b=!1;a=a||window.event;a.which?b=3==a.which:a.button&&(b=2==a.button);!0==b?Ua=!0:Va=!0;Y=a.altKey;Z=a.ctrlKey;$=a.shiftKey}function ab(a){var b=!1;a=a||window.event;a.which?b=3==a.which:a.button&&(b=2==a.button);!0==b?Ua=!1:Va=!1}function bb(a){var b=a.clientX;a=a.clientY;Ya=b-Wa;Za=a-Xa;Wa=b;Xa=a;!0==Va&&!0!=Y&&!0!=Z&&!0!=$&&X.gc(0.5*Ya,0.5*Za);!0!=Ua&&(!0!=Va||!0!=Y&&!0!=Z&&!0!=$)||X.rotate(0.4*Ya,0.4*Za)} function cb(a){a.preventDefault&&a.preventDefault();a.returnValue=!1;var b=0,b=a.wheelDelta,b=(a=a.detail)?b?b/a/40*(0<=a?1:-1):-a/3:b/120;!0==isNaN(b)&&(b=0);b=0>b?1:-1;"observer"==X.Ob()?X.zoom(17.5*b):X.zoom(7*b)}function db(a){"undefined"==typeof a&&(a=window.event);Y=a.altKey;Z=a.ctrlKey;$=a.shiftKey} function eb(a){"undefined"==typeof a&&(a=window.event);if(a)switch(window.event?window.event.keyCode:a.which?a.which:a.charCode){case 49:X.ab("manual");break;case 50:X.ab("drone");break;case 51:X.ab("observer")}Y=a.altKey;Z=a.ctrlKey;$=a.shiftKey} window.startDemo=function(){!1==t.Gb()?alert("Unfturtunately, Melown Maps need browser support for WebGL. Sorry."):(X=new W("demo","./mapConfig.json",null,Ta),document.onmousedown=$a,document.oncontextmenu=function(){return!1},document.onmouseup=ab,document.onmousemove=bb,window.addEventListener("DOMMouseScroll",cb,!0),window.addEventListener("mousewheel",cb,!0),document.onselectstart=function(){return!1},document.onkeyup=eb,document.onkeydown=db)};</script>
</head>
<body style = "padding: 0; margin: 0;" onload="startDemo()">
<div id="demo" style="width:100%; height:100%;"></div>
<div style="position:fixed;left:5px;bottom:5px; width:185; height: 80px; background-color: rgba(250,250,250,0.95); border-radius: 5px;">
<img style="padding-left:18px;padding-top:14px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJgAAAA3CAYAAADwiIMaAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2tpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDowMDgwMTE3NDA3MjA2ODExODNEMUY3QUI5MDk4Njc3RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3OTI3MTM5NEJBMzkxMUUzOEM4MkE2ODY0RjgzODcwQyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3OTI3MTM5M0JBMzkxMUUzOEM4MkE2ODY0RjgzODcwQyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDoyN2Y5YmRiOS0yNTIyLTQwMmQtODM3NC0yNTE4MDUxMGM5OGYiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MDA4MDExNzQwNzIwNjgxMTgzRDFGN0FCOTA5ODY3N0QiLz4gPC9yZGY6RGVz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">
</div>
</body>
</html>